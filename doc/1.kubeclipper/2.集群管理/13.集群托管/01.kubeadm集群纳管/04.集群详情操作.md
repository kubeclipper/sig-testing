##### 集群详情操作

1. 访问kubectl

|||
| ---- | ---- |
| 编号 | 集群管理-集群-纳管集群详情-访问kubectl-1 |
| 测试点 | 1. 纳管集群访问kubectl |
| 预置条件 | 1. 已纳管 kubeadm 集群\
2. 已运行执行终端命令的 pod |
| 步骤 | 1.点击纳管集群名称-更多-访问kubectl \
2. 在终端中执行命令kubectl get po -A |
| 预期结果 | 1. 步骤1中，跳转到终端页面\
2. 步骤2中，可以在终端中成功得到返回 |

2. 编辑

|||
| ---- | ---- |
| 编号 | 集群管理-集群-纳管集群详情-编辑-2 |
| 测试点 | 1. 纳管集群编辑 |
| 预置条件 | 1. 已纳管 kubeadm 集群 |
| 步骤 | 1. 点击纳管集群名称-更多-集群设置-编辑按钮\
2. 输入集群描述‘test-des',正确的外部访问ip，标签test-key:test-value，点击“确定”按钮\
3. 查看集群列表\
4. 查看集群详情 |
| 预期结果 | 1. 步骤1中，跳转到编辑集群页面\
2. 步骤2中，编辑集群成功\
3. 步骤3中，集群描述更新为'test-desc'\
4. 步骤4中，基本信息显示标签test-key:test-value |

3. 添加CRI镜像仓库

|||
| ---- | ---- |
| 编号 | 集群管理-集群-纳管集群详情-添加CRI镜像仓库-3 |
| 测试点 | 1. 纳管集群添加CRI镜像仓库 |
| 预置条件 | 1. 已纳管 kubeadm 集群\
2.存在可用的镜像仓库10.1.0.234:5000 |
| 步骤 | 1. 点击"纳管集群-更多-集群设置-CRI 镜像仓库"\
2. 在弹出的界面中点击"添加",在新增的输入框中选择 http 镜像仓库 10.1.0.234:5000(test-http)\
3. 进入节点中, 执行 cat /etc/docker/daemon.json\
4. 执行 docker pull 10.1.0.234:5000/busybox |
| 预期结果 | 1. 步骤1中，跳转到添加 CRI 镜像仓库配置页面\
2. 步骤2中，配置信息正确，CRI 镜像仓库添加成功，跳转到集群列表页面\
3. 步骤3中，/etc/docker/daemon.json 会新增一行 "insecure-registries": ["10.1.0.234:5000"]\
4. 步骤4中，可以拉下来镜像 busybox |

4. 添加节点

|||
| ---- | ---- |
| 编号 | 集群管理-集群托管-纳管集群详情-添加节点-4 |
| 测试点 | 1. 纳管集群添加节点 |
| 预置条件 | 1. 已纳管 kubeadm 集群\
2.存在一个空闲节点 |
| 步骤 | 1.点击纳管集群名称-更多-节点管理-添加节点\
2. 勾选空闲节点添加到worker节点中|
| 预期结果 | 1. 步骤1中，弹出添加节点页面\
2.步骤2中，集群状态为“更新中”，数分钟后节点添加成功，集群状态为“运行中” |

5. 移除节点

|||
| ---- | ---- |
| 编号 | 集群管理-集群托管-纳管集群详情-移除节点-5 |
| 测试点 | 1. 纳管集群移除节点 |
| 预置条件 | 1. 已纳管 kubeadm 集群，且集群中存在两个节点 |
| 步骤 | 1.点击纳管集群名称-更多-节点管理-移除节点\
2. 勾选worker节点将其移除|
| 预期结果 | 1. 步骤1中，弹出移除节点页面\
2.步骤2中，集群状态为“更新中”，数分钟后节点移除成功，集群状态为“运行中” |

6. 备份恢复

|||
| ---- | ---- |
| 编号 | 集群管理-集群-纳管集群详情-备份恢复-6 |
| 测试点 | 1. 纳管集群的备份恢复 |
| 预置条件 | 1. 已纳管 kubeadm 集群\
2、已在集群中添加备份点 |
| 步骤 | 1.点击纳管集群名称-更多-备份和恢复-备份集群 \
2. 点击集群管理-纳管集群名称-备份 \
3. 选择一个备份-更多-恢复|
| 预期结果 | 1. 步骤1中，弹出备份集群页面，输入备份名称，点击确定\
2. 步骤2中，显示该集群下所有备份\
3. 步骤3中，弹出恢复页面，点击确定，备份状态显示“恢复中”，等待数分钟后状态正常|

7. 添加存储项

|||
| ---- | ---- |
| 编号 | 集群管理-集群-纳管集群详情-添加存储项-7 |
| 测试点 | 1. 纳管集群的添加存储项 |
| 预置条件 | 1. 已纳管 kubeadm 集群\
2、已有可用的nfs存储 |
| 步骤 | 1.点击纳管集群名称-更多-插件管理添加存储项 \
2. 输入存储项信息，点击确认 |
| 预期结果 | 1. 步骤1中，跳转到添加存储项页面\
2. 步骤2中，存储添加成功，集群状态显示“更新中”,数分钟后集群状态显示“运行中”|

8. 更新集群证书

|||
| ---- | ---- |
| 编号 | 集群管理-集群托管-纳管集群详情-更新集群证书-9 |
| 测试点 | 1. 纳管集群更新集群证书 |
| 预置条件 | 1. 已纳管 kubeadm 集群 |
| 步骤 | 1.点击纳管集群名称-更多-证书管理-更新集群证书 \
2. 等待集群状态变为运行中，点击集群名称进入集群详情 |
| 预期结果 | 1. 步骤1中，跳转到集群证书页面，确认后集群状态为“更新中”\
2. 步骤2中，证书过期时间被更新为一年后的当前时间 |

9. 查看kubeconfig文件

|||
| ---- | ---- |
| 编号 | 集群管理-集群托管-纳管集群详情-查看kubeconfig文件-10 |
| 测试点 | 1. 纳管集群查看kubeconfig文件 |
| 预置条件 | 1. 已纳管 kubeadm 集群 |
| 步骤 | 1.点击纳管集群名称-更多-证书管理-查看kubeconfig文件 |
| 预期结果 | 1. 步骤1中，可以正常显示集群的kubeconfig文件 |
